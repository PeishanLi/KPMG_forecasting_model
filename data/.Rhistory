value = as.numeric(value),
value_prev = as.numeric(c(NA, value[2:length(value) - 1])),
qoq_change = (value - value_prev)/ value) %>%
select(year, quarter, value, value_prev, qoq_change)
ppe
sp500bs[11,]
View(ppe)
dv
colnames(dv) <- dv[2,]
dv
View(dv)
colnames(dv) <- dv[1,]
dv <- dv[-c(1:2),]
dv %>%
mutate(year = Year,
quarter = as.numeric(gsub("Q", "", Quarter))) %>%
rename(dv = `Annualized EBITDA Per Share Growth minus 10-Year`)
dv %>%
mutate(year = Year,
quarter = as.numeric(gsub("Q", "", Quarter))) %>%
rename(dv = `Annualized EBITDA Per Share Growth minus 10-Year`) %>%
select(year, quarter, dv)
dv <- dv %>%
mutate(year = Year,
quarter = as.numeric(gsub("Q", "", Quarter))) %>%
rename(dv = `Annualized EBITDA Per Share Growth minus 10-Year`) %>%
select(year, quarter, dv)
dv <- dv %>%
mutate(year = Year,
quarter = as.numeric(gsub("Q", "", Quarter)),
dv = gsub("%", "", `Annualized EBITDA Per Share Growth minus 10-Year`)) %>%
select(year, quarter, dv)
dv <- read_csv("target_variable.csv")
colnames(dv) <- dv[1,]
dv <- dv[-c(1:2),]
dv <- dv %>%
mutate(year = Year,
quarter = as.numeric(gsub("Q", "", Quarter)),
dv = gsub("%", "", `Annualized EBITDA Per Share Growth minus 10-Year`)) %>%
select(year, quarter, dv)
dv
dv <- dv %>%
mutate(year = Year,
quarter = as.numeric(gsub("Q", "", Quarter)),
dv = as.numeric(gsub("%", "", `Annualized EBITDA Per Share Growth minus 10-Year`))/100) %>%
select(year, quarter, dv)
dv <- read_csv("target_variable.csv")
colnames(dv) <- dv[1,]
dv <- dv[-c(1:2),]
dv <- dv %>%
mutate(year = Year,
quarter = as.numeric(gsub("Q", "", Quarter)),
dv = as.numeric(gsub("%", "", `Annualized EBITDA Per Share Growth minus 10-Year`))/100) %>%
select(year, quarter, dv)
dv
inv <- sp500bs[8,] %>%
pivot_longer(cols = c(2:81)) %>%
mutate(time_parse = gsub("3 months\nCQ", "", name),
year = as.numeric(word(time_parse, -1)),
quarter = as.numeric(word(time_parse, 1)),
value = as.numeric(value),
value_prev = as.numeric(c(NA, value[2:length(value) - 1])),
qoq_change = (value - value_prev)/ value) %>%
select(year, quarter, value, value_prev, qoq_change)
cor(inv$qoq_change, dv$dv)
dv <- read_csv("target_variable.csv")
colnames(dv) <- dv[1,]
dv <- dv[-c(1),]
dv <- dv %>%
mutate(year = Year,
quarter = as.numeric(gsub("Q", "", Quarter)),
dv = as.numeric(gsub("%", "", `Annualized EBITDA Per Share Growth minus 10-Year`))/100) %>%
select(year, quarter, dv)
cor(inv$qoq_change, dv$dv)
cor(inv$qoq_change, dv$dv)
df <- left_join(dv, inv %>% rename(inv_change = "qoq_change"), by = c("year", "quarter"))
dv
dv <- dv %>%
mutate(year = as.numeric(Year),
quarter = as.numeric(gsub("Q", "", Quarter)),
dv = as.numeric(gsub("%", "", `Annualized EBITDA Per Share Growth minus 10-Year`))/100) %>%
select(year, quarter, dv)
dv <- read_csv("target_variable.csv")
colnames(dv) <- dv[1,]
dv <- dv[-c(1:2),]
dv <- dv %>%
mutate(year = as.numeric(Year),
quarter = as.numeric(gsub("Q", "", Quarter)),
dv = as.numeric(gsub("%", "", `Annualized EBITDA Per Share Growth minus 10-Year`))/100) %>%
select(year, quarter, dv)
df <- left_join(dv, inv %>% rename(inv_change = "qoq_change"), by = c("year", "quarter"))
cor(df$inv_change, df$dv)
df <- dv %>%
left_join(inv %>% rename(inv_change = "qoq_change"),
by = c("year", "quarter")) %>%
left_join(ppe %>% rename(ppe_change = "qoq_change"),
by = c("year", "quarter"))
df
inv <- sp500bs[8,] %>%
pivot_longer(cols = c(2:81)) %>%
mutate(time_parse = gsub("3 months\nCQ", "", name),
year = as.numeric(word(time_parse, -1)),
quarter = as.numeric(word(time_parse, 1)),
value = as.numeric(value),
value_prev = as.numeric(c(NA, value[2:length(value) - 1])),
qoq_change = (value - value_prev)/ value) %>%
select(year, quarter, qoq_change)
ppe <- sp500bs[11,] %>%
pivot_longer(cols = c(2:81)) %>%
mutate(time_parse = gsub("3 months\nCQ", "", name),
year = as.numeric(word(time_parse, -1)),
quarter = as.numeric(word(time_parse, 1)),
value = as.numeric(value),
value_prev = as.numeric(c(NA, value[2:length(value) - 1])),
qoq_change = (value - value_prev)/ value) %>%
select(year, quarter, qoq_change)
df <- dv %>%
left_join(inv %>% rename(inv_change = "qoq_change"),
by = c("year", "quarter")) %>%
left_join(ppe %>% rename(ppe_change = "qoq_change"),
by = c("year", "quarter"))
df
cor(df$ppe_change, df$dv)
bus_conf
# ---- business confidence ----
bus_conf <- read_csv("business_conf_idx.csv") %>%
mutate(year = as.numeric(gsub("-.*", "", TIME)),
month = as.numeric(str_remove(TIME, paste0(year, "-"))),
quarter = ifelse(month %in% c(1:3), 1,
ifelse(month %in% c(4:6), 2,
ifelse(month %in% c(7:9), 3,
ifelse(month %in% c(10:12), 4, NA))))) %>%
filter(year > 2000) %>%
group_by(year, quarter) %>%
summarise(value = mean(Value)) %>%
ungroup() %>%
mutate(value_prev = c(NA, value[2:length(value) - 1]),
qoq_change = (value - value_prev)/ value) %>%
select(year, quarter, dv)
df <- dv %>%
left_join(bus_conf %>% rename(bus_conf_change = "qoq_change"),
by = c("year", "quarter")) %>%
left_join(inv %>% rename(inv_change = "qoq_change"),
by = c("year", "quarter")) %>%
left_join(ppe %>% rename(ppe_change = "qoq_change"),
by = c("year", "quarter"))
df
bus_conf
# ---- business confidence ----
bus_conf <- read_csv("business_conf_idx.csv") %>%
mutate(year = as.numeric(gsub("-.*", "", TIME)),
month = as.numeric(str_remove(TIME, paste0(year, "-"))),
quarter = ifelse(month %in% c(1:3), 1,
ifelse(month %in% c(4:6), 2,
ifelse(month %in% c(7:9), 3,
ifelse(month %in% c(10:12), 4, NA))))) %>%
filter(year > 2000) %>%
group_by(year, quarter) %>%
summarise(value = mean(Value)) %>%
ungroup() %>%
mutate(value_prev = c(NA, value[2:length(value) - 1]),
qoq_change = (value - value_prev)/ value) %>%
select(year, quarter, dv)
# ---- business confidence ----
bus_conf <- read_csv("business_conf_idx.csv") %>%
mutate(year = as.numeric(gsub("-.*", "", TIME)),
month = as.numeric(str_remove(TIME, paste0(year, "-"))),
quarter = ifelse(month %in% c(1:3), 1,
ifelse(month %in% c(4:6), 2,
ifelse(month %in% c(7:9), 3,
ifelse(month %in% c(10:12), 4, NA))))) %>%
filter(year > 2000) %>%
group_by(year, quarter) %>%
summarise(value = mean(Value)) %>%
ungroup() %>%
mutate(value_prev = c(NA, value[2:length(value) - 1]),
qoq_change = (value - value_prev)/ value) %>%
select(year, quarter, qoq_change)
df <- dv %>%
left_join(bus_conf %>% rename(bus_conf_change = "qoq_change"),
by = c("year", "quarter")) %>%
left_join(inv %>% rename(inv_change = "qoq_change"),
by = c("year", "quarter")) %>%
left_join(ppe %>% rename(ppe_change = "qoq_change"),
by = c("year", "quarter"))
df
View(con_cred)
con_cred <- read_csv("total_consumer_credit_in_millions_dollars.csv")
View(con_cred)
con_cred <- read_csv("total_consumer_credit_in_millions_dollars.csv")
View(con_cred)
con_cred <- con_cred[-c(1:5)]
View(con_cred)
con_cred <- con_cred[-c(1:5),]
View(con_cred)
View(con_cred)
con_cred %>%
rename(TIME = `Series Description`,
value = `Total consumer credit owned and securitized, not seasonally adjusted level`) %>%
mutate(year = as.numeric(gsub("-.*", "", TIME)),
month = as.numeric(str_remove(TIME, paste0(year, "-"))),
quarter = ifelse(month %in% c(1:3), 1,
ifelse(month %in% c(4:6), 2,
ifelse(month %in% c(7:9), 3,
ifelse(month %in% c(10:12), 4, NA))))) %>%
filter(year > 2000) %>%
group_by(year, quarter) %>%
summarise(value = mean(value))
con_cred %>%
rename(TIME = `Series Description`,
value = `Total consumer credit owned and securitized, not seasonally adjusted level`) %>%
mutate(year = as.numeric(gsub("-.*", "", TIME)),
month = as.numeric(str_remove(TIME, paste0(year, "-"))),
quarter = ifelse(month %in% c(1:3), 1,
ifelse(month %in% c(4:6), 2,
ifelse(month %in% c(7:9), 3,
ifelse(month %in% c(10:12), 4, NA)))),
value = as.numeric(value)) %>%
filter(year > 2000) %>%
group_by(year, quarter) %>%
summarise(value = mean(value))
con_cred %>%
rename(TIME = `Series Description`,
value = `Total consumer credit owned and securitized, not seasonally adjusted level`) %>%
mutate(year = as.numeric(gsub("-.*", "", TIME)),
month = as.numeric(str_remove(TIME, paste0(year, "-"))),
quarter = ifelse(month %in% c(1:3), 1,
ifelse(month %in% c(4:6), 2,
ifelse(month %in% c(7:9), 3,
ifelse(month %in% c(10:12), 4, NA)))),
value = as.numeric(value)) %>%
filter(year > 2000) %>%
group_by(year, quarter) %>%
summarise(value = mean(value)) %>%
ungroup() %>%
mutate(value_prev = as.numeric(c(NA, value[2:length(value) - 1])),
qoq_change = (value - value_prev)/ value) %>%
select(year, quarter, qoq_change)
con_cred <- con_cred[-c(1:5),] %>%
rename(TIME = `Series Description`,
value = `Total consumer credit owned and securitized, not seasonally adjusted level`) %>%
mutate(year = as.numeric(gsub("-.*", "", TIME)),
month = as.numeric(str_remove(TIME, paste0(year, "-"))),
quarter = ifelse(month %in% c(1:3), 1,
ifelse(month %in% c(4:6), 2,
ifelse(month %in% c(7:9), 3,
ifelse(month %in% c(10:12), 4, NA)))),
value = as.numeric(value)) %>%
filter(year > 2000) %>%
group_by(year, quarter) %>%
summarise(value = mean(value)) %>%
ungroup() %>%
mutate(value_prev = as.numeric(c(NA, value[2:length(value) - 1])),
qoq_change = (value - value_prev)/ value) %>%
select(year, quarter, qoq_change)
cpi <- read_csv("CPI.csv")
cpi
View(cpi)
month = as.numeric(word(time_parsed, 2))
mutate(time_parsed = gsub("/", " ", DATE),
cpi
cpi %>%
mutate(time_parsed = gsub("/", " ", DATE),
year = as.numeric(word(time_parsed, 1)),
month = as.numeric(word(time_parsed, 2)))
cpi
cpi %>%
mutate(time_parsed = gsub("/", " ", DATE))
cpi %>%
mutate(time_parsed = gsub("/", " ", DATE),
year = word(time_parsed, 1),
year = as.numeric(year),
month = word(time_parsed, 2),
month = as.numeric(month))
ifelse(month %in% c(10:12), 4, NA))))
ifelse(month %in% c(10:12), 4, NA)))
cpi %>%
mutate(time_parsed = gsub("/", " ", DATE),
year = word(time_parsed, 1),
year = as.numeric(year),
month = word(time_parsed, 2),
month = as.numeric(month),
quarter = ifelse(month %in% c(1:3), 1,
ifelse(month %in% c(4:6), 2,
ifelse(month %in% c(7:9), 3,
ifelse(month %in% c(10:12), 4, NA)))))
cpi %>%
mutate(time_parsed = gsub("/", " ", DATE),
year = word(time_parsed, 1),
year = as.numeric(year),
month = word(time_parsed, 2),
month = as.numeric(month),
quarter = ifelse(month %in% c(1:3), 1,
ifelse(month %in% c(4:6), 2,
ifelse(month %in% c(7:9), 3,
ifelse(month %in% c(10:12), 4, NA)))),
qoq_change = cpi/100)
cpi %>%
mutate(time_parsed = gsub("/", " ", DATE),
year = word(time_parsed, 1),
year = as.numeric(year),
month = word(time_parsed, 2),
month = as.numeric(month),
quarter = ifelse(month %in% c(1:3), 1,
ifelse(month %in% c(4:6), 2,
ifelse(month %in% c(7:9), 3,
ifelse(month %in% c(10:12), 4, NA)))),
qoq_change = cpi/100) %>%
select(year, quarter, qoq_change)
cpi <- cpi %>%
mutate(time_parsed = gsub("/", " ", DATE),
year = word(time_parsed, 1),
year = as.numeric(year),
month = word(time_parsed, 2),
month = as.numeric(month),
quarter = ifelse(month %in% c(1:3), 1,
ifelse(month %in% c(4:6), 2,
ifelse(month %in% c(7:9), 3,
ifelse(month %in% c(10:12), 4, NA)))),
qoq_change = cpi/100) %>%
select(year, quarter, qoq_change)
View(cons_exp)
cons_exp
cons_exp %>%
mutate(time_parsed = gsub("/", " ", DATE),
year = word(time_parsed, -1),
year = as.numeric(year),
month = word(time_parsed, 1),
month = as.numeric(month),
quarter = ifelse(month %in% c(1:3), 1,
ifelse(month %in% c(4:6), 2,
ifelse(month %in% c(7:9), 3,
ifelse(month %in% c(10:12), 4, NA)))),
qoq_change = pce/100) %>%
select(year, quarter, qoq_change)
cons_exp <- cons_exp %>%
mutate(time_parsed = gsub("/", " ", DATE),
year = word(time_parsed, -1),
year = as.numeric(year),
month = word(time_parsed, 1),
month = as.numeric(month),
quarter = ifelse(month %in% c(1:3), 1,
ifelse(month %in% c(4:6), 2,
ifelse(month %in% c(7:9), 3,
ifelse(month %in% c(10:12), 4, NA)))),
qoq_change = pce/100) %>%
select(year, quarter, qoq_change)
ppi
ppi <- ppi %>%
mutate(time_parsed = gsub("/", " ", DATE),
year = word(time_parsed, 1),
year = as.numeric(year),
month = word(time_parsed, 2),
month = as.numeric(month),
quarter = ifelse(month %in% c(1:3), 1,
ifelse(month %in% c(4:6), 2,
ifelse(month %in% c(7:9), 3,
ifelse(month %in% c(10:12), 4, NA)))),
qoq_change = ppi/100) %>%
select(year, quarter, qoq_change)
ppi
vix
vix %>%
mutate(time_parsed = gsub("/", " ", DATE),
year = word(time_parsed, 1),
year = as.numeric(year),
month = word(time_parsed, 2),
month = as.numeric(month),
quarter = ifelse(month %in% c(1:3), 1,
ifelse(month %in% c(4:6), 2,
ifelse(month %in% c(7:9), 3,
ifelse(month %in% c(10:12), 4, NA)))),
value = OPEN) %>%
filter(year > 2000) %>%
group_by(year, quarter) %>%
summarise(value = mean(value)) %>%
ungroup() %>%
mutate(value_prev = as.numeric(c(NA, value[2:length(value) - 1])),
qoq_change = (value - value_prev)/ value) %>%
select(year, quarter, qoq_change)
vix %>%
mutate(time_parsed = gsub("/", " ", DATE),
year = word(time_parsed, 1),
year = as.numeric(year),
month = word(time_parsed, 2),
month = as.numeric(month),
quarter = ifelse(month %in% c(1:3), 1,
ifelse(month %in% c(4:6), 2,
ifelse(month %in% c(7:9), 3,
ifelse(month %in% c(10:12), 4, NA)))),
value = OPEN) %>%
filter(year > 2000) %>%
group_by(year, quarter) %>%
summarise(value = mean(value)) %>%
ungroup()
vix
vix %>%
mutate(time_parsed = gsub("/", " ", DATE),
year = word(time_parsed, 1),
year = as.numeric(year),
month = word(time_parsed, 2),
month = as.numeric(month),
quarter = ifelse(month %in% c(1:3), 1,
ifelse(month %in% c(4:6), 2,
ifelse(month %in% c(7:9), 3,
ifelse(month %in% c(10:12), 4, NA)))),
value = OPEN) %>%
filter(year > 2000) %>%
group_by(year, quarter) %>%
summarise(value = mean(value))
vix %>%
mutate(time_parsed = gsub("/", " ", DATE),
year = word(time_parsed, 1),
year = as.numeric(year),
month = word(time_parsed, 2),
month = as.numeric(month),
quarter = ifelse(month %in% c(1:3), 1,
ifelse(month %in% c(4:6), 2,
ifelse(month %in% c(7:9), 3,
ifelse(month %in% c(10:12), 4, NA)))),
value = OPEN)
vix %>%
mutate(time_parsed = gsub("/", " ", DATE),
year = word(time_parsed, -1),
year = as.numeric(year),
month = word(time_parsed, 1),
month = as.numeric(month),
quarter = ifelse(month %in% c(1:3), 1,
ifelse(month %in% c(4:6), 2,
ifelse(month %in% c(7:9), 3,
ifelse(month %in% c(10:12), 4, NA)))),
value = OPEN)
vix %>%
mutate(time_parsed = gsub("/", " ", DATE),
year = word(time_parsed, -1),
year = as.numeric(year),
month = word(time_parsed, 1),
month = as.numeric(month),
quarter = ifelse(month %in% c(1:3), 1,
ifelse(month %in% c(4:6), 2,
ifelse(month %in% c(7:9), 3,
ifelse(month %in% c(10:12), 4, NA)))),
value = OPEN) %>%
filter(year > 2000) %>%
group_by(year, quarter) %>%
summarise(value = mean(value)) %>%
ungroup() %>%
mutate(value_prev = as.numeric(c(NA, value[2:length(value) - 1])),
qoq_change = (value - value_prev)/ value) %>%
select(year, quarter, qoq_change)
vix <- vix %>%
mutate(time_parsed = gsub("/", " ", DATE),
year = word(time_parsed, -1),
year = as.numeric(year),
month = word(time_parsed, 1),
month = as.numeric(month),
quarter = ifelse(month %in% c(1:3), 1,
ifelse(month %in% c(4:6), 2,
ifelse(month %in% c(7:9), 3,
ifelse(month %in% c(10:12), 4, NA)))),
value = OPEN) %>%
filter(year > 2000) %>%
group_by(year, quarter) %>%
summarise(value = mean(value)) %>%
ungroup() %>%
mutate(value_prev = as.numeric(c(NA, value[2:length(value) - 1])),
qoq_change = (value - value_prev)/ value) %>%
select(year, quarter, qoq_change)
df <- dv %>%
left_join(bus_conf %>% rename(bus_conf_change = "qoq_change"),
by = c("year", "quarter")) %>%
left_join(con_cred %>% rename(con_cred_change = "qoq_change"),
by = c("year", "quarter")) %>%
left_join(cpi %>% rename(cpi_change = "qoq_change"),
by = c("year", "quarter")) %>%
left_join(cons_exp %>% rename(con_exp_change = "qoq_change"),
by = c("year", "quarter")) %>%
left_join(ppi %>% rename(ppi_change = "qoq_change"),
by = c("year", "quarter")) %>%
left_join(vix %>% rename(vix_change = "qoq_change"),
by = c("year", "quarter")) %>%
left_join(inv %>% rename(inv_change = "qoq_change"),
by = c("year", "quarter")) %>%
left_join(ppe %>% rename(ppe_change = "qoq_change"),
by = c("year", "quarter"))
df
summary(lm(dv ~ bus_conf + con_cred + cpi + con_exp + ppi + vix + inv + ppe, df))
df <- dv %>%
left_join(bus_conf %>% rename(bus_conf = "qoq_change"),
by = c("year", "quarter")) %>%
left_join(con_cred %>% rename(con_cred = "qoq_change"),
by = c("year", "quarter")) %>%
left_join(cpi %>% rename(cpi = "qoq_change"),
by = c("year", "quarter")) %>%
left_join(cons_exp %>% rename(con_exp = "qoq_change"),
by = c("year", "quarter")) %>%
left_join(ppi %>% rename(ppi = "qoq_change"),
by = c("year", "quarter")) %>%
left_join(vix %>% rename(vix = "qoq_change"),
by = c("year", "quarter")) %>%
left_join(inv %>% rename(inv = "qoq_change"),
by = c("year", "quarter")) %>%
left_join(ppe %>% rename(ppe = "qoq_change"),
by = c("year", "quarter"))
summary(lm(dv ~ bus_conf + con_cred + cpi + con_exp + ppi + vix + inv + ppe, df))
write_csv(df, "out/data.csv")
setwd("G:/My Drive/KPMG/KPMG_forecasting_model/data/")
write_csv(df, "out/data.csv")
write_csv(df, "./out/data.csv")
write_csv(df, "data.csv")
write_csv(df, "final/data.csv")
write_csv(df, "out/data.csv")
